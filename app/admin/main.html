<style type="text/css">
    body {
        background: rgb(245,245,247);
    }
</style>
<div id="projector"
     fullscreen
     style="width: 100%; height: 100%"
     ng-controller="ProjectorCtrl"
     ng-show="is_full_screen()"
     ng-include src="'app/projector/projector_main.html'">

</div>
<span id="adminpage">
    <div class="container-fluid non-homepage">
        <div class="row header event-header"
             style="background-size: cover"
             layout="row" layout-align="center start"
             ng-if="data.Event.cover_photo_url != null && data.Event.cover_photo_url.length >= 4"
             ng-style="{'background-image':'url('+data.Event.cover_photo_url+')', 'width': '100%', 'background-position' : 'left center'}">
            <div layout="column" style="">
                <h1 class="event-title">{{ event.name }}</h1>
            </div>
            <div style="width: 300px"> </div>
        </div>
        <div class="row content" style="margin-left: 15px; margin-right: 15px">
            <!-- Creating new notifications -->
            <div class="col-md-12">
                <div ng-include src="'app/admin/send_notification.html'">
                </div>
            </div>
            <!-- Stats -->
            <div class="col-md-12 stats">
                <div class="stat actual-stat" style="padding-bottom: 15px">
                    <div class="col-xs-4 stat">
                        <div class="stat-text">
                            <span class="stat-number"> 187 </span>
                            <div>
                                <span class="stat-unit">Total Subscribers</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-4 stat">
                        <div class="stat-text">
                            <span class="stat-number"> {{ data.Event.total_broadcasts }}</span>
                            <div>
                                <span class="stat-unit">Total Broadcasts</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-4 stat">
                        <div class="stat-text">
                            <span class="stat-number">55</span>
                            <div>
                                <span class="stat-unit">Amazing People</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="two col-md-8" style="margin-bottom: 15px">
                <div class="actual-feed-wrapper event-info" style="padding: 0">

                    <md-tabs md-dynamic-height md-border-bottom class="md-accent">
                        <md-tab label="event info">
                            <md-content class="md-padding">
                                <div class="col-md-12">
                                    <a ng-click="ToggleFullScreen()" class="btn btn-primary">
                                        Go Fullscreen <i class="glyphicon mdi mdi-fullscreen"></i>
                                    </a>
                                </div>


                                <div class="col-md-12">
                                    <label> Event Description </label>
                                    <div class="editable-item">
                                        <span editable-textarea="data.Event.description" onaftersave="publish_updates()" e-form="event_description_form">
                                            {{ data.Event.description || 'Describe this event here!' }}
                                        </span>
                                        <button class="btn-default" ng-click="event_description_form.$show()" ng-hide="event_description_form.$visible">
                                            <i class="glyphicon glyphicon-pencil"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label> Twitter Widget Id </label>
                                    <div class="editable-item">
                                        <span editable-text="data.Event.twitter_widget_id" onaftersave="publish_updates()" e-form="twitter_hashtag_form">
                                            {{ data.Event.twitter_widget_id || 'Your twitter widget id' }}
                                        </span>
                                        <button class="btn-default" ng-click="twitter_hashtag_form.$show()" ng-hide="twitter_hashtag_form.$visible">
                                            <i class="glyphicon glyphicon-pencil"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label> Cover Photo </label>
                                    <div class="editable-item">
                                        <a editable-text="data.Event.cover_photo_url"
                                           ng-href="{{data.Event.cover_photo_url}}"
                                           blur="ignore"
                                           e-form="cover_photo_editor"
                                           e-ng-model="data.Event.cover_photo_url"
                                           onhide="cover_photo_toggle();"
                                           onshow="cover_photo_toggle()"
                                           oncancel="revert_changes()"
                                           onaftersave="publish_updates()"
                                           popover-placement="bottom">
                                            <!--popover-trigger="mouseenter">-->
                                            {{ data.Event.cover_photo_url || "Upload a cover photo now!" }}
                                        </a>
                                        <button class="btn-default" ng-click="cover_photo_editor.$show()" ng-hide="cover_photo_editor.$visible">
                                            <i class="glyphicon glyphicon-pencil"></i>
                                        </button>
                                    </div>
                                    <div ng-show="editing_cover_photo" class="slide" ng-class="{'load-block' : loading  }">
                                        <div ngf-drop ng-model="$parent.cover_photo_files" class="drop-box"
                                             ngf-drag-over-class="dragover" ngf-multiple="true" ngf-allow-dir="true"
                                             ngf-accept="'.jpg,.png,'">
                                            Drop Image files (.jpg .png) here
                                        </div>
                                        <div ngf-no-file-drop>File Drag/Drop is not supported for this browser</div>
                                        <button class="btn btn-default"
                                                ngf-select
                                                ng-disabled="loading"
                                                ng-click="cover_photo_editor.$show()"
                                                ng-model="$parent.cover_photo_files">
                                            Choose file
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label> Event Map  </label>
                                    <div class="editable-item">
                                        <a editable-text="data.Event.event_map_url"
                                           ng-href="{{data.Event.event_map_url}}"
                                           blur="ignore"
                                           e-form="event_map_editor"
                                           e-ng-model="data.Event.event_map_url"
                                           onhide="map_url_toggle()"
                                           onshow="map_url_toggle()"
                                           oncancel="revert_changes()"
                                           onaftersave="    publish_updates()"
                                           popover-placement="bottom">
                                            <!--popover-trigger="mouseenter">-->
                                            {{ data.Event.event_map_url  || "Upload an event map now!" }}
                                        </a>
                                        <button class="btn-default" ng-click="event_map_editor.$show()" ng-hide="event_map_editor.$visible">
                                            <i class="glyphicon glyphicon-pencil"></i>
                                        </button>
                                    </div>

                                    <div ng-show="editing_map_url" class="slide" ng-class="{'load-block' : loading  }">
                                        <div ngf-drop ng-model="$parent.event_map_files" class="drop-box"
                                             ngf-drag-over-class="dragover" ngf-multiple="true" ngf-allow-dir="true"
                                             ngf-accept="'.jpg,.png,'">Drop Image files (.jpg .png) here</div>
                                        <div ngf-no-file-drop>File Drag/Drop is not supported for this browser</div>
                                        <button class="btn btn-default"
                                                ngf-select
                                                ng-disabled="loading"
                                                ng-model="$parent.event_map_files">
                                            Choose file
                                        </button>
                                    </div>

                                </div>
                                <div class="col-md-12">
                                    <label> Start time</label>
                                    <div ng-hide="timeoption.editing">
                                        {{ format_date(data.Event.start_time) }}
                                    </div>
                                    <div class="dropdown">
                                        <a class="dropdown-toggle" ng-show="timeoption.editing">
                                            <div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="input-group-date">
                                                            <div style="width: 100%" class="input-group" combinedtpicker 
                                                                 tz-name="data.Event.timezone_offset"
                                                                 ng-model="timeoption.start_time"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </a>

                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label> End time</label>
                                    <div ng-hide="timeoption.editing">
                                        <div class="editable-item">
                                            <div style="width:100%">{{ format_date(data.Event.end_time) }}</div>
                                            <button class="btn-default" ng-click="timeoption.edit()" ng-hide="timeoption.editing">
                                                <i class="glyphicon glyphicon-pencil"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="dropdown">
                                        <a class="dropdown-toggle" ng-show="timeoption.editing">
                                            <div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="input-group-date">
                                                            <div style="width: 100%" class="input-group" combinedtpicker 
                                                                 tz-name="data.Event.timezone_offset"
                                                                 ng-model="timeoption.end_time"></div>
                                                            <div style="width: 95px; border-bottom: none;" class="editable-item">
                                                                <button class="btn-default btn-primary" ng-click="timeoption.save()">
                                                                    <i class="glyphicon glyphicon-ok"></i>
                                                                </button>
                                                                <button style="margin-left: 5px" class="btn-default btn-default" ng-click="timeoption.cancel()">
                                                                    <i class="glyphicon glyphicon-remove"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label> Location Address </label>
                                    <div>
                                        <!--<input class="form-control ng-valid ng-dirty" id="google_places_ac" name="google_places_ac" type="text" ng-model="data.Event.address" placeholder="Enter a location" autocomplete="off" style="">-->
                                        <script type="text/ng-template" id="searchbox.tpl.html">
                                            <input class="form-control ng-valid ng-dirty" type="text" id="searchbox" ng-model="data.Event.address" placeholder="Enter an address" autocomplete="off" style="width: 40%; margin-top: 15px;">
                                        </script>
                                        <ui-gmap-google-map center="data.Event.map.center" zoom="data.Event.map.zoom" draggable="true" options="options">
                                            <ui-gmap-search-box template="searchbox.template" events="searchbox.events"></ui-gmap-search-box>
                                            <ui-gmap-marker idkey='1'
                                                            coords='data.Event.marker.coords'>
                                            </ui-gmap-marker>
                                        </ui-gmap-google-map>
                                    </div>
                                </div>

                            </md-content>
                        </md-tab>
                        <md-tab label="Timetable" md-on-select="show_calendar($event)">
                            <md-content class="md-padding" style="padding-bottom: 20px">
                                <div id="timetable_c" ng-click="timetable_clicked($event)"
                                     style="padding-bottom:30px"
                                     ng-class="{'timetable-disabled' : !calendar_editable  }"
                                     ui-calendar="data.Event.uiConfig.calendar"
                                     ng-model="data.Event.event_sources" calendar="timetable_c"></div>
                            </md-content>
                        </md-tab>
                        <md-tab label="Scheduled Notifications" md-on-select="">
                            <md-content class="md-padding" style="padding-bottom: 20px">
                                <div ng-include src="'app/admin/scheduled_notifications.html'"> </div>
                            </md-content>
                        </md-tab>
                    </md-tabs>
                    <div class="subeventeditor">
                        <div ng-show="editing_subevent"
                             ng-style="{'margin-left': event_editor_popup.posX +  'px', 'margin-top': event_editor_popup.posY + 'px'}"
                             class="subevent-editor-side">
                            <form class="subevent-editor-form"
                                  style="margin-bottom: 0"
                                  editable-form name="subevent_editor"
                                  oncancel="cancel_subevent_editing()"
                                  onaftersave="save_subevent()" class="slide">
                                <div>
                                    <!-- editable username (text with validation) -->
                                    <span class="title">Event name: </span>
                                    <span editable-text="partial_subevent.name" focus-me="autofocused" e-name="name" e-required>
                                        {{ partial_subevent.name || 'Enter an event name!' }}
                                    </span>
                                </div>
                                <div>
                                    <span class="title">Description: </span>
                                    <span editable-text="partial_subevent.description" e-name="description">
                                        {{ partial_subevent.description || 'Enter a description!' }}
                                    </span>
                                </div>
                                <div>
                                    <span class="title">Location:</span>
                                    <span editable-text="partial_subevent.location" e-name="location" e-required>
                                        {{ partial_subevent.location || 'Enter a location!' }}
                                    </span>
                                </div>
                                <div>
                                    <div class="input-group">
                                        <span style="width: 50px; padding-top: 5px;" class="title">Start</span>
                                        <div ng-if="editing_subevent" class="input-group" combinedtpicker
                                             tz-name="data.Event.timezone_offset"
                                             ng-model="partial_subevent.start_time"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="input-group">
                                        <span style="width: 50px; padding-top: 5px;" class="title">End</span>
                                        <div ng-if="editing_subevent" class="input-group" combinedtpicker
                                             tz-name="data.Event.timezone_offset"
                                             ng-model="partial_subevent.end_time"></div>
                                    </div>
                                </div>
                                <div>
                                    <!-- buttons to submit / cancel form -->
                                    <span ng-show="subevent_editor.$visible">
                                        <button type="submit" class="btn btn-primary" ng-disabled="subevent_editor.$waiting">
                                            Save
                                        </button>
                                        <button type="button" class="btn btn-default" ng-disabled="subevent_editor.$waiting" ng-click="subevent_editor.$cancel()">
                                            Cancel
                                        </button>
                                    </span>
                                </div>
                            </form>
                        </div>
                    </div>


                </div>
            </div>
            <!-- Feeds -->
            <div class="two col-md-4">
                <div class "slide"
                     ng-repeat="channel in data.Event.channels"
                     ng-show="channel.selected">
                    <div class="actual-feed-wrapper">
                        <div class="row box-title red">
                            <div style="float:left; ">
                                NOTIFICATIONS
                            </div>
                        </div>
                        <div class="actual-feed">
                            <div class="feed-item" ng-repeat="notif in channel.notifications">
                                <div class="feed-item-text">


                                    <b>{{ notif.type }}</b> - <span class="lighter-color"> {{ notif.time }} </span>
                                    <!--<
                                    a ng-href="#event_admin/{{event.name}}/{{notif.id}}?event_id={{event.id}}"> More info </a>-->


                                </div>
                                <div class="feed-item-text">{{ notif.notification_guts }}</div>
                            </div>


                            <div style="margin-top: 5px; border-top: 1px solid lightgrey" ng-if="channel.selected && notif.responses_pie_chart !== undefined && notif.responses_pie_chart.labels.length > 0">
                                <center>
                                    <p ng-if="notif.number_responses == 0"> No responses yet! </p>
                                    <p ng-if="notif.number_responses > 0"> {{ notif.number_responses }} responses </p>
                                </center>
                                <canvas class="chart chart-pie"
                                        height="75%"
                                        data="notif.responses_pie_chart.data"
                                        labels="notif.responses_pie_chart.labels"
                                        legend="true"
                                        options="options"
                                        click="onClick"></canvas>
                            </div>
                        </div>
                        <div class="feed-item" ng-show="channel.notifications.length == 0">
                            <div class="feed-item-text"> It's lonely in here - send a message now! </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</span>
